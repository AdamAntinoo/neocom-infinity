# INTEGRATIONS - Docker Composer components
# PROJECT CODE - 52
#
# Docker composer automatically creates a network. The container host matches the container name. To differentiate and create single
#   networks use a directory name that should be unique. The recommended format is: <project>-docker-<environment>
#
# The integration environment will use a real OAuth authentication and also will deal directly with the ESI SSO and backend services.
#   All mocks are disabled and the calls will progress to real services with real data, but the backend repository and the applications
#   will run in local and not in the Heroku servers.
#
# The list of project ports is on the document:
#   {REPOSITORY}/README.md

version: '3.8'

services:
  neocom-backend-integration-postgres:
    container_name: neocom-backend-integration-postgres
    image: "postgres:11.2"
    ports:
      - "5282:5432"
    environment:
      - CURRENT_UID=1000
      - POSTGRES_DB=postgres
      - POSTGRES_USER=neocom-user
      - POSTGRES_PASSWORD=neocom-password

  neocom-backend-integration-app:
    container_name: neocom-backend-integration-app
    image: neocom/neocom-infinity.backend
    ports:
      - "5242:9500"
    environment:
      - SPRING_PROFILES_ACTIVE=default
      - JDBC_DATABASE_URL=jdbc:postgresql://neocom-backend-integration-postgres:5432/postgres
      - NEOCOM_DATABASE_URL=jdbc:postgresql://neocom-backend-integration-postgres:5432/postgres?user=neocom-user&password=neocom-password
      - DB_USER=neocom-user
      - DB_PASSWORD=neocom-password
      - NEOCOM_BANNER_LOCATION=./app-banner.txt
      - PROPERTIES_DIRECTORY=/properties-integration
      - SDE_DATABASE_PATH=/sde.db
      - APPLICATION_DIRECTORY=./NeoCom.Infinity.Integration
      - PROFILE=production
      - SPRING_DATASOURCE_URL=jdbc:postgresql://neocom-backend-integration-postgres:5432/postgres
      - SPRING_DATASOURCE_USERNAME=neocom-user
      - SPRING_DATASOURCE_PASSWORD=neocom-password
